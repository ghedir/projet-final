{"ast":null,"code":"const runningProcs = new Set();\nlet handlersInstalled = false;\nconst forwardedSignals = ['SIGINT', 'SIGTERM'];\n\nconst handleSignal = signal => {\n  for (const proc of runningProcs) {\n    proc.kill(signal);\n  }\n};\n\nconst setupListeners = () => {\n  for (const signal of forwardedSignals) {\n    process.on(signal, handleSignal);\n  }\n\n  handlersInstalled = true;\n};\n\nconst cleanupListeners = () => {\n  if (runningProcs.size === 0) {\n    for (const signal of forwardedSignals) {\n      process.removeListener(signal, handleSignal);\n    }\n\n    handlersInstalled = false;\n  }\n};\n\nconst add = proc => {\n  runningProcs.add(proc);\n  if (!handlersInstalled) setupListeners();\n  proc.once('exit', () => {\n    runningProcs.delete(proc);\n    cleanupListeners();\n  });\n};\n\nmodule.exports = {\n  add,\n  handleSignal,\n  forwardedSignals\n};","map":{"version":3,"sources":["C:/Users/ghedi/Documents/GhedBlog/node_modules/npm/node_modules/@npmcli/run-script/lib/signal-manager.js"],"names":["runningProcs","Set","handlersInstalled","forwardedSignals","handleSignal","signal","proc","kill","setupListeners","process","on","cleanupListeners","size","removeListener","add","once","delete","module","exports"],"mappings":"AAAA,MAAMA,YAAY,GAAG,IAAIC,GAAJ,EAArB;AACA,IAAIC,iBAAiB,GAAG,KAAxB;AAEA,MAAMC,gBAAgB,GAAG,CACvB,QADuB,EAEvB,SAFuB,CAAzB;;AAKA,MAAMC,YAAY,GAAGC,MAAM,IAAI;AAC7B,OAAK,MAAMC,IAAX,IAAmBN,YAAnB,EAAiC;AAC/BM,IAAAA,IAAI,CAACC,IAAL,CAAUF,MAAV;AACD;AACF,CAJD;;AAMA,MAAMG,cAAc,GAAG,MAAM;AAC3B,OAAK,MAAMH,MAAX,IAAqBF,gBAArB,EAAuC;AACrCM,IAAAA,OAAO,CAACC,EAAR,CAAWL,MAAX,EAAmBD,YAAnB;AACD;;AACDF,EAAAA,iBAAiB,GAAG,IAApB;AACD,CALD;;AAOA,MAAMS,gBAAgB,GAAG,MAAM;AAC7B,MAAIX,YAAY,CAACY,IAAb,KAAsB,CAA1B,EAA6B;AAC3B,SAAK,MAAMP,MAAX,IAAqBF,gBAArB,EAAuC;AACrCM,MAAAA,OAAO,CAACI,cAAR,CAAuBR,MAAvB,EAA+BD,YAA/B;AACD;;AACDF,IAAAA,iBAAiB,GAAG,KAApB;AACD;AACF,CAPD;;AASA,MAAMY,GAAG,GAAGR,IAAI,IAAI;AAClBN,EAAAA,YAAY,CAACc,GAAb,CAAiBR,IAAjB;AACA,MAAI,CAACJ,iBAAL,EACEM,cAAc;AAEhBF,EAAAA,IAAI,CAACS,IAAL,CAAU,MAAV,EAAkB,MAAM;AACtBf,IAAAA,YAAY,CAACgB,MAAb,CAAoBV,IAApB;AACAK,IAAAA,gBAAgB;AACjB,GAHD;AAID,CATD;;AAWAM,MAAM,CAACC,OAAP,GAAiB;AACfJ,EAAAA,GADe;AAEfV,EAAAA,YAFe;AAGfD,EAAAA;AAHe,CAAjB","sourcesContent":["const runningProcs = new Set()\nlet handlersInstalled = false\n\nconst forwardedSignals = [\n  'SIGINT',\n  'SIGTERM'\n]\n\nconst handleSignal = signal => {\n  for (const proc of runningProcs) {\n    proc.kill(signal)\n  }\n}\n\nconst setupListeners = () => {\n  for (const signal of forwardedSignals) {\n    process.on(signal, handleSignal)\n  }\n  handlersInstalled = true\n}\n\nconst cleanupListeners = () => {\n  if (runningProcs.size === 0) {\n    for (const signal of forwardedSignals) {\n      process.removeListener(signal, handleSignal)\n    }\n    handlersInstalled = false\n  }\n}\n\nconst add = proc => {\n  runningProcs.add(proc)\n  if (!handlersInstalled)\n    setupListeners()\n\n  proc.once('exit', () => {\n    runningProcs.delete(proc)\n    cleanupListeners()\n  })\n}\n\nmodule.exports = {\n  add,\n  handleSignal,\n  forwardedSignals\n}\n"]},"metadata":{},"sourceType":"script"}