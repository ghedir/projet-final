{"ast":null,"code":"var isValidSemver = require('semver/functions/valid');\n\nvar cleanSemver = require('semver/functions/clean');\n\nvar validateLicense = require('validate-npm-package-license');\n\nvar hostedGitInfo = require('hosted-git-info');\n\nvar isBuiltinModule = require('is-core-module');\n\nvar depTypes = ['dependencies', 'devDependencies', 'optionalDependencies'];\n\nvar extractDescription = require('./extract_description');\n\nvar url = require('url');\n\nvar typos = require('./typos.json');\n\nmodule.exports = {\n  // default warning function\n  warn: function () {},\n  fixRepositoryField: function (data) {\n    if (data.repositories) {\n      this.warn('repositories');\n      data.repository = data.repositories[0];\n    }\n\n    if (!data.repository) {\n      return this.warn('missingRepository');\n    }\n\n    if (typeof data.repository === 'string') {\n      data.repository = {\n        type: 'git',\n        url: data.repository\n      };\n    }\n\n    var r = data.repository.url || '';\n\n    if (r) {\n      var hosted = hostedGitInfo.fromUrl(r);\n\n      if (hosted) {\n        r = data.repository.url = hosted.getDefaultRepresentation() === 'shortcut' ? hosted.https() : hosted.toString();\n      }\n    }\n\n    if (r.match(/github.com\\/[^/]+\\/[^/]+\\.git\\.git$/)) {\n      this.warn('brokenGitUrl', r);\n    }\n  },\n  fixTypos: function (data) {\n    Object.keys(typos.topLevel).forEach(function (d) {\n      if (Object.prototype.hasOwnProperty.call(data, d)) {\n        this.warn('typo', d, typos.topLevel[d]);\n      }\n    }, this);\n  },\n  fixScriptsField: function (data) {\n    if (!data.scripts) {\n      return;\n    }\n\n    if (typeof data.scripts !== 'object') {\n      this.warn('nonObjectScripts');\n      delete data.scripts;\n      return;\n    }\n\n    Object.keys(data.scripts).forEach(function (k) {\n      if (typeof data.scripts[k] !== 'string') {\n        this.warn('nonStringScript');\n        delete data.scripts[k];\n      } else if (typos.script[k] && !data.scripts[typos.script[k]]) {\n        this.warn('typo', k, typos.script[k], 'scripts');\n      }\n    }, this);\n  },\n  fixFilesField: function (data) {\n    var files = data.files;\n\n    if (files && !Array.isArray(files)) {\n      this.warn('nonArrayFiles');\n      delete data.files;\n    } else if (data.files) {\n      data.files = data.files.filter(function (file) {\n        if (!file || typeof file !== 'string') {\n          this.warn('invalidFilename', file);\n          return false;\n        } else {\n          return true;\n        }\n      }, this);\n    }\n  },\n  fixBinField: function (data) {\n    if (!data.bin) {\n      return;\n    }\n\n    if (typeof data.bin === 'string') {\n      var b = {};\n      var match;\n\n      if (match = data.name.match(/^@[^/]+[/](.*)$/)) {\n        b[match[1]] = data.bin;\n      } else {\n        b[data.name] = data.bin;\n      }\n\n      data.bin = b;\n    }\n  },\n  fixManField: function (data) {\n    if (!data.man) {\n      return;\n    }\n\n    if (typeof data.man === 'string') {\n      data.man = [data.man];\n    }\n  },\n  fixBundleDependenciesField: function (data) {\n    var bdd = 'bundledDependencies';\n    var bd = 'bundleDependencies';\n\n    if (data[bdd] && !data[bd]) {\n      data[bd] = data[bdd];\n      delete data[bdd];\n    }\n\n    if (data[bd] && !Array.isArray(data[bd])) {\n      this.warn('nonArrayBundleDependencies');\n      delete data[bd];\n    } else if (data[bd]) {\n      data[bd] = data[bd].filter(function (bd) {\n        if (!bd || typeof bd !== 'string') {\n          this.warn('nonStringBundleDependency', bd);\n          return false;\n        } else {\n          if (!data.dependencies) {\n            data.dependencies = {};\n          }\n\n          if (Object.prototype.hasOwnProperty.call(data.dependencies, bd)) {\n            this.warn('nonDependencyBundleDependency', bd);\n            data.dependencies[bd] = '*';\n          }\n\n          return true;\n        }\n      }, this);\n    }\n  },\n  fixDependencies: function (data, strict) {\n    objectifyDeps(data, this.warn);\n    addOptionalDepsToDeps(data, this.warn);\n    this.fixBundleDependenciesField(data);\n    ['dependencies', 'devDependencies'].forEach(function (deps) {\n      if (!(deps in data)) {\n        return;\n      }\n\n      if (!data[deps] || typeof data[deps] !== 'object') {\n        this.warn('nonObjectDependencies', deps);\n        delete data[deps];\n        return;\n      }\n\n      Object.keys(data[deps]).forEach(function (d) {\n        var r = data[deps][d];\n\n        if (typeof r !== 'string') {\n          this.warn('nonStringDependency', d, JSON.stringify(r));\n          delete data[deps][d];\n        }\n\n        var hosted = hostedGitInfo.fromUrl(data[deps][d]);\n\n        if (hosted) {\n          data[deps][d] = hosted.toString();\n        }\n      }, this);\n    }, this);\n  },\n  fixModulesField: function (data) {\n    if (data.modules) {\n      this.warn('deprecatedModules');\n      delete data.modules;\n    }\n  },\n  fixKeywordsField: function (data) {\n    if (typeof data.keywords === 'string') {\n      data.keywords = data.keywords.split(/,\\s+/);\n    }\n\n    if (data.keywords && !Array.isArray(data.keywords)) {\n      delete data.keywords;\n      this.warn('nonArrayKeywords');\n    } else if (data.keywords) {\n      data.keywords = data.keywords.filter(function (kw) {\n        if (typeof kw !== 'string' || !kw) {\n          this.warn('nonStringKeyword');\n          return false;\n        } else {\n          return true;\n        }\n      }, this);\n    }\n  },\n  fixVersionField: function (data, strict) {\n    // allow \"loose\" semver 1.0 versions in non-strict mode\n    // enforce strict semver 2.0 compliance in strict mode\n    var loose = !strict;\n\n    if (!data.version) {\n      data.version = '';\n      return true;\n    }\n\n    if (!isValidSemver(data.version, loose)) {\n      throw new Error('Invalid version: \"' + data.version + '\"');\n    }\n\n    data.version = cleanSemver(data.version, loose);\n    return true;\n  },\n  fixPeople: function (data) {\n    modifyPeople(data, unParsePerson);\n    modifyPeople(data, parsePerson);\n  },\n  fixNameField: function (data, options) {\n    if (typeof options === 'boolean') {\n      options = {\n        strict: options\n      };\n    } else if (typeof options === 'undefined') {\n      options = {};\n    }\n\n    var strict = options.strict;\n\n    if (!data.name && !strict) {\n      data.name = '';\n      return;\n    }\n\n    if (typeof data.name !== 'string') {\n      throw new Error('name field must be a string.');\n    }\n\n    if (!strict) {\n      data.name = data.name.trim();\n    }\n\n    ensureValidName(data.name, strict, options.allowLegacyCase);\n\n    if (isBuiltinModule(data.name)) {\n      this.warn('conflictingName', data.name);\n    }\n  },\n  fixDescriptionField: function (data) {\n    if (data.description && typeof data.description !== 'string') {\n      this.warn('nonStringDescription');\n      delete data.description;\n    }\n\n    if (data.readme && !data.description) {\n      data.description = extractDescription(data.readme);\n    }\n\n    if (data.description === undefined) {\n      delete data.description;\n    }\n\n    if (!data.description) {\n      this.warn('missingDescription');\n    }\n  },\n  fixReadmeField: function (data) {\n    if (!data.readme) {\n      this.warn('missingReadme');\n      data.readme = 'ERROR: No README data found!';\n    }\n  },\n  fixBugsField: function (data) {\n    if (!data.bugs && data.repository && data.repository.url) {\n      var hosted = hostedGitInfo.fromUrl(data.repository.url);\n\n      if (hosted && hosted.bugs()) {\n        data.bugs = {\n          url: hosted.bugs()\n        };\n      }\n    } else if (data.bugs) {\n      var emailRe = /^.+@.*\\..+$/;\n\n      if (typeof data.bugs === 'string') {\n        if (emailRe.test(data.bugs)) {\n          data.bugs = {\n            email: data.bugs\n          };\n          /* eslint-disable-next-line node/no-deprecated-api */\n        } else if (url.parse(data.bugs).protocol) {\n          data.bugs = {\n            url: data.bugs\n          };\n        } else {\n          this.warn('nonEmailUrlBugsString');\n        }\n      } else {\n        bugsTypos(data.bugs, this.warn);\n        var oldBugs = data.bugs;\n        data.bugs = {};\n\n        if (oldBugs.url) {\n          /* eslint-disable-next-line node/no-deprecated-api */\n          if (typeof oldBugs.url === 'string' && url.parse(oldBugs.url).protocol) {\n            data.bugs.url = oldBugs.url;\n          } else {\n            this.warn('nonUrlBugsUrlField');\n          }\n        }\n\n        if (oldBugs.email) {\n          if (typeof oldBugs.email === 'string' && emailRe.test(oldBugs.email)) {\n            data.bugs.email = oldBugs.email;\n          } else {\n            this.warn('nonEmailBugsEmailField');\n          }\n        }\n      }\n\n      if (!data.bugs.email && !data.bugs.url) {\n        delete data.bugs;\n        this.warn('emptyNormalizedBugs');\n      }\n    }\n  },\n  fixHomepageField: function (data) {\n    if (!data.homepage && data.repository && data.repository.url) {\n      var hosted = hostedGitInfo.fromUrl(data.repository.url);\n\n      if (hosted && hosted.docs()) {\n        data.homepage = hosted.docs();\n      }\n    }\n\n    if (!data.homepage) {\n      return;\n    }\n\n    if (typeof data.homepage !== 'string') {\n      this.warn('nonUrlHomepage');\n      return delete data.homepage;\n    }\n    /* eslint-disable-next-line node/no-deprecated-api */\n\n\n    if (!url.parse(data.homepage).protocol) {\n      data.homepage = 'http://' + data.homepage;\n    }\n  },\n  fixLicenseField: function (data) {\n    const license = data.license || data.licence;\n\n    if (!license) {\n      return this.warn('missingLicense');\n    }\n\n    if (typeof license !== 'string' || license.length < 1 || license.trim() === '') {\n      return this.warn('invalidLicense');\n    }\n\n    if (!validateLicense(license).validForNewPackages) {\n      return this.warn('invalidLicense');\n    }\n  }\n};\n\nfunction isValidScopedPackageName(spec) {\n  if (spec.charAt(0) !== '@') {\n    return false;\n  }\n\n  var rest = spec.slice(1).split('/');\n\n  if (rest.length !== 2) {\n    return false;\n  }\n\n  return rest[0] && rest[1] && rest[0] === encodeURIComponent(rest[0]) && rest[1] === encodeURIComponent(rest[1]);\n}\n\nfunction isCorrectlyEncodedName(spec) {\n  return !spec.match(/[/@\\s+%:]/) && spec === encodeURIComponent(spec);\n}\n\nfunction ensureValidName(name, strict, allowLegacyCase) {\n  if (name.charAt(0) === '.' || !(isValidScopedPackageName(name) || isCorrectlyEncodedName(name)) || strict && !allowLegacyCase && name !== name.toLowerCase() || name.toLowerCase() === 'node_modules' || name.toLowerCase() === 'favicon.ico') {\n    throw new Error('Invalid name: ' + JSON.stringify(name));\n  }\n}\n\nfunction modifyPeople(data, fn) {\n  if (data.author) {\n    data.author = fn(data.author);\n  }\n\n  ['maintainers', 'contributors'].forEach(function (set) {\n    if (!Array.isArray(data[set])) {\n      return;\n    }\n\n    data[set] = data[set].map(fn);\n  });\n  return data;\n}\n\nfunction unParsePerson(person) {\n  if (typeof person === 'string') {\n    return person;\n  }\n\n  var name = person.name || '';\n  var u = person.url || person.web;\n  var url = u ? ' (' + u + ')' : '';\n  var e = person.email || person.mail;\n  var email = e ? ' <' + e + '>' : '';\n  return name + email + url;\n}\n\nfunction parsePerson(person) {\n  if (typeof person !== 'string') {\n    return person;\n  }\n\n  var name = person.match(/^([^(<]+)/);\n  var url = person.match(/\\(([^)]+)\\)/);\n  var email = person.match(/<([^>]+)>/);\n  var obj = {};\n\n  if (name && name[0].trim()) {\n    obj.name = name[0].trim();\n  }\n\n  if (email) {\n    obj.email = email[1];\n  }\n\n  if (url) {\n    obj.url = url[1];\n  }\n\n  return obj;\n}\n\nfunction addOptionalDepsToDeps(data, warn) {\n  var o = data.optionalDependencies;\n\n  if (!o) {\n    return;\n  }\n\n  var d = data.dependencies || {};\n  Object.keys(o).forEach(function (k) {\n    d[k] = o[k];\n  });\n  data.dependencies = d;\n}\n\nfunction depObjectify(deps, type, warn) {\n  if (!deps) {\n    return {};\n  }\n\n  if (typeof deps === 'string') {\n    deps = deps.trim().split(/[\\n\\r\\s\\t ,]+/);\n  }\n\n  if (!Array.isArray(deps)) {\n    return deps;\n  }\n\n  warn('deprecatedArrayDependencies', type);\n  var o = {};\n  deps.filter(function (d) {\n    return typeof d === 'string';\n  }).forEach(function (d) {\n    d = d.trim().split(/(:?[@\\s><=])/);\n    var dn = d.shift();\n    var dv = d.join('');\n    dv = dv.trim();\n    dv = dv.replace(/^@/, '');\n    o[dn] = dv;\n  });\n  return o;\n}\n\nfunction objectifyDeps(data, warn) {\n  depTypes.forEach(function (type) {\n    if (!data[type]) {\n      return;\n    }\n\n    data[type] = depObjectify(data[type], type, warn);\n  });\n}\n\nfunction bugsTypos(bugs, warn) {\n  if (!bugs) {\n    return;\n  }\n\n  Object.keys(bugs).forEach(function (k) {\n    if (typos.bugs[k]) {\n      warn('typo', k, typos.bugs[k], 'bugs');\n      bugs[typos.bugs[k]] = bugs[k];\n      delete bugs[k];\n    }\n  });\n}","map":{"version":3,"sources":["C:/Users/ghedi/Documents/GhedBlog/node_modules/npm/node_modules/normalize-package-data/lib/fixer.js"],"names":["isValidSemver","require","cleanSemver","validateLicense","hostedGitInfo","isBuiltinModule","depTypes","extractDescription","url","typos","module","exports","warn","fixRepositoryField","data","repositories","repository","type","r","hosted","fromUrl","getDefaultRepresentation","https","toString","match","fixTypos","Object","keys","topLevel","forEach","d","prototype","hasOwnProperty","call","fixScriptsField","scripts","k","script","fixFilesField","files","Array","isArray","filter","file","fixBinField","bin","b","name","fixManField","man","fixBundleDependenciesField","bdd","bd","dependencies","fixDependencies","strict","objectifyDeps","addOptionalDepsToDeps","deps","JSON","stringify","fixModulesField","modules","fixKeywordsField","keywords","split","kw","fixVersionField","loose","version","Error","fixPeople","modifyPeople","unParsePerson","parsePerson","fixNameField","options","trim","ensureValidName","allowLegacyCase","fixDescriptionField","description","readme","undefined","fixReadmeField","fixBugsField","bugs","emailRe","test","email","parse","protocol","bugsTypos","oldBugs","fixHomepageField","homepage","docs","fixLicenseField","license","licence","length","validForNewPackages","isValidScopedPackageName","spec","charAt","rest","slice","encodeURIComponent","isCorrectlyEncodedName","toLowerCase","fn","author","set","map","person","u","web","e","mail","obj","o","optionalDependencies","depObjectify","dn","shift","dv","join","replace"],"mappings":"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","sourcesContent":["var isValidSemver = require('semver/functions/valid')\nvar cleanSemver = require('semver/functions/clean')\nvar validateLicense = require('validate-npm-package-license')\nvar hostedGitInfo = require('hosted-git-info')\nvar isBuiltinModule = require('is-core-module')\nvar depTypes = ['dependencies', 'devDependencies', 'optionalDependencies']\nvar extractDescription = require('./extract_description')\nvar url = require('url')\nvar typos = require('./typos.json')\n\nmodule.exports = {\n  // default warning function\n  warn: function () {},\n\n  fixRepositoryField: function (data) {\n    if (data.repositories) {\n      this.warn('repositories')\n      data.repository = data.repositories[0]\n    }\n    if (!data.repository) {\n      return this.warn('missingRepository')\n    }\n    if (typeof data.repository === 'string') {\n      data.repository = {\n        type: 'git',\n        url: data.repository,\n      }\n    }\n    var r = data.repository.url || ''\n    if (r) {\n      var hosted = hostedGitInfo.fromUrl(r)\n      if (hosted) {\n        r = data.repository.url\n          = hosted.getDefaultRepresentation() === 'shortcut' ? hosted.https() : hosted.toString()\n      }\n    }\n\n    if (r.match(/github.com\\/[^/]+\\/[^/]+\\.git\\.git$/)) {\n      this.warn('brokenGitUrl', r)\n    }\n  },\n\n  fixTypos: function (data) {\n    Object.keys(typos.topLevel).forEach(function (d) {\n      if (Object.prototype.hasOwnProperty.call(data, d)) {\n        this.warn('typo', d, typos.topLevel[d])\n      }\n    }, this)\n  },\n\n  fixScriptsField: function (data) {\n    if (!data.scripts) {\n      return\n    }\n    if (typeof data.scripts !== 'object') {\n      this.warn('nonObjectScripts')\n      delete data.scripts\n      return\n    }\n    Object.keys(data.scripts).forEach(function (k) {\n      if (typeof data.scripts[k] !== 'string') {\n        this.warn('nonStringScript')\n        delete data.scripts[k]\n      } else if (typos.script[k] && !data.scripts[typos.script[k]]) {\n        this.warn('typo', k, typos.script[k], 'scripts')\n      }\n    }, this)\n  },\n\n  fixFilesField: function (data) {\n    var files = data.files\n    if (files && !Array.isArray(files)) {\n      this.warn('nonArrayFiles')\n      delete data.files\n    } else if (data.files) {\n      data.files = data.files.filter(function (file) {\n        if (!file || typeof file !== 'string') {\n          this.warn('invalidFilename', file)\n          return false\n        } else {\n          return true\n        }\n      }, this)\n    }\n  },\n\n  fixBinField: function (data) {\n    if (!data.bin) {\n      return\n    }\n    if (typeof data.bin === 'string') {\n      var b = {}\n      var match\n      if (match = data.name.match(/^@[^/]+[/](.*)$/)) {\n        b[match[1]] = data.bin\n      } else {\n        b[data.name] = data.bin\n      }\n      data.bin = b\n    }\n  },\n\n  fixManField: function (data) {\n    if (!data.man) {\n      return\n    }\n    if (typeof data.man === 'string') {\n      data.man = [data.man]\n    }\n  },\n  fixBundleDependenciesField: function (data) {\n    var bdd = 'bundledDependencies'\n    var bd = 'bundleDependencies'\n    if (data[bdd] && !data[bd]) {\n      data[bd] = data[bdd]\n      delete data[bdd]\n    }\n    if (data[bd] && !Array.isArray(data[bd])) {\n      this.warn('nonArrayBundleDependencies')\n      delete data[bd]\n    } else if (data[bd]) {\n      data[bd] = data[bd].filter(function (bd) {\n        if (!bd || typeof bd !== 'string') {\n          this.warn('nonStringBundleDependency', bd)\n          return false\n        } else {\n          if (!data.dependencies) {\n            data.dependencies = {}\n          }\n          if (Object.prototype.hasOwnProperty.call(data.dependencies, bd)) {\n            this.warn('nonDependencyBundleDependency', bd)\n            data.dependencies[bd] = '*'\n          }\n          return true\n        }\n      }, this)\n    }\n  },\n\n  fixDependencies: function (data, strict) {\n    objectifyDeps(data, this.warn)\n    addOptionalDepsToDeps(data, this.warn)\n    this.fixBundleDependenciesField(data)\n\n    ;['dependencies', 'devDependencies'].forEach(function (deps) {\n      if (!(deps in data)) {\n        return\n      }\n      if (!data[deps] || typeof data[deps] !== 'object') {\n        this.warn('nonObjectDependencies', deps)\n        delete data[deps]\n        return\n      }\n      Object.keys(data[deps]).forEach(function (d) {\n        var r = data[deps][d]\n        if (typeof r !== 'string') {\n          this.warn('nonStringDependency', d, JSON.stringify(r))\n          delete data[deps][d]\n        }\n        var hosted = hostedGitInfo.fromUrl(data[deps][d])\n        if (hosted) {\n          data[deps][d] = hosted.toString()\n        }\n      }, this)\n    }, this)\n  },\n\n  fixModulesField: function (data) {\n    if (data.modules) {\n      this.warn('deprecatedModules')\n      delete data.modules\n    }\n  },\n\n  fixKeywordsField: function (data) {\n    if (typeof data.keywords === 'string') {\n      data.keywords = data.keywords.split(/,\\s+/)\n    }\n    if (data.keywords && !Array.isArray(data.keywords)) {\n      delete data.keywords\n      this.warn('nonArrayKeywords')\n    } else if (data.keywords) {\n      data.keywords = data.keywords.filter(function (kw) {\n        if (typeof kw !== 'string' || !kw) {\n          this.warn('nonStringKeyword')\n          return false\n        } else {\n          return true\n        }\n      }, this)\n    }\n  },\n\n  fixVersionField: function (data, strict) {\n    // allow \"loose\" semver 1.0 versions in non-strict mode\n    // enforce strict semver 2.0 compliance in strict mode\n    var loose = !strict\n    if (!data.version) {\n      data.version = ''\n      return true\n    }\n    if (!isValidSemver(data.version, loose)) {\n      throw new Error('Invalid version: \"' + data.version + '\"')\n    }\n    data.version = cleanSemver(data.version, loose)\n    return true\n  },\n\n  fixPeople: function (data) {\n    modifyPeople(data, unParsePerson)\n    modifyPeople(data, parsePerson)\n  },\n\n  fixNameField: function (data, options) {\n    if (typeof options === 'boolean') {\n      options = {strict: options}\n    } else if (typeof options === 'undefined') {\n      options = {}\n    }\n    var strict = options.strict\n    if (!data.name && !strict) {\n      data.name = ''\n      return\n    }\n    if (typeof data.name !== 'string') {\n      throw new Error('name field must be a string.')\n    }\n    if (!strict) {\n      data.name = data.name.trim()\n    }\n    ensureValidName(data.name, strict, options.allowLegacyCase)\n    if (isBuiltinModule(data.name)) {\n      this.warn('conflictingName', data.name)\n    }\n  },\n\n  fixDescriptionField: function (data) {\n    if (data.description && typeof data.description !== 'string') {\n      this.warn('nonStringDescription')\n      delete data.description\n    }\n    if (data.readme && !data.description) {\n      data.description = extractDescription(data.readme)\n    }\n    if (data.description === undefined) {\n      delete data.description\n    }\n    if (!data.description) {\n      this.warn('missingDescription')\n    }\n  },\n\n  fixReadmeField: function (data) {\n    if (!data.readme) {\n      this.warn('missingReadme')\n      data.readme = 'ERROR: No README data found!'\n    }\n  },\n\n  fixBugsField: function (data) {\n    if (!data.bugs && data.repository && data.repository.url) {\n      var hosted = hostedGitInfo.fromUrl(data.repository.url)\n      if (hosted && hosted.bugs()) {\n        data.bugs = {url: hosted.bugs()}\n      }\n    } else if (data.bugs) {\n      var emailRe = /^.+@.*\\..+$/\n      if (typeof data.bugs === 'string') {\n        if (emailRe.test(data.bugs)) {\n          data.bugs = {email: data.bugs}\n        /* eslint-disable-next-line node/no-deprecated-api */\n        } else if (url.parse(data.bugs).protocol) {\n          data.bugs = {url: data.bugs}\n        } else {\n          this.warn('nonEmailUrlBugsString')\n        }\n      } else {\n        bugsTypos(data.bugs, this.warn)\n        var oldBugs = data.bugs\n        data.bugs = {}\n        if (oldBugs.url) {\n          /* eslint-disable-next-line node/no-deprecated-api */\n          if (typeof (oldBugs.url) === 'string' && url.parse(oldBugs.url).protocol) {\n            data.bugs.url = oldBugs.url\n          } else {\n            this.warn('nonUrlBugsUrlField')\n          }\n        }\n        if (oldBugs.email) {\n          if (typeof (oldBugs.email) === 'string' && emailRe.test(oldBugs.email)) {\n            data.bugs.email = oldBugs.email\n          } else {\n            this.warn('nonEmailBugsEmailField')\n          }\n        }\n      }\n      if (!data.bugs.email && !data.bugs.url) {\n        delete data.bugs\n        this.warn('emptyNormalizedBugs')\n      }\n    }\n  },\n\n  fixHomepageField: function (data) {\n    if (!data.homepage && data.repository && data.repository.url) {\n      var hosted = hostedGitInfo.fromUrl(data.repository.url)\n      if (hosted && hosted.docs()) {\n        data.homepage = hosted.docs()\n      }\n    }\n    if (!data.homepage) {\n      return\n    }\n\n    if (typeof data.homepage !== 'string') {\n      this.warn('nonUrlHomepage')\n      return delete data.homepage\n    }\n    /* eslint-disable-next-line node/no-deprecated-api */\n    if (!url.parse(data.homepage).protocol) {\n      data.homepage = 'http://' + data.homepage\n    }\n  },\n\n  fixLicenseField: function (data) {\n    const license = data.license || data.licence\n    if (!license) {\n      return this.warn('missingLicense')\n    }\n    if (\n      typeof (license) !== 'string' ||\n      license.length < 1 ||\n      license.trim() === ''\n    ) {\n      return this.warn('invalidLicense')\n    }\n    if (!validateLicense(license).validForNewPackages) {\n      return this.warn('invalidLicense')\n    }\n  },\n}\n\nfunction isValidScopedPackageName (spec) {\n  if (spec.charAt(0) !== '@') {\n    return false\n  }\n\n  var rest = spec.slice(1).split('/')\n  if (rest.length !== 2) {\n    return false\n  }\n\n  return rest[0] && rest[1] &&\n    rest[0] === encodeURIComponent(rest[0]) &&\n    rest[1] === encodeURIComponent(rest[1])\n}\n\nfunction isCorrectlyEncodedName (spec) {\n  return !spec.match(/[/@\\s+%:]/) &&\n    spec === encodeURIComponent(spec)\n}\n\nfunction ensureValidName (name, strict, allowLegacyCase) {\n  if (name.charAt(0) === '.' ||\n      !(isValidScopedPackageName(name) || isCorrectlyEncodedName(name)) ||\n      (strict && (!allowLegacyCase) && name !== name.toLowerCase()) ||\n      name.toLowerCase() === 'node_modules' ||\n      name.toLowerCase() === 'favicon.ico') {\n    throw new Error('Invalid name: ' + JSON.stringify(name))\n  }\n}\n\nfunction modifyPeople (data, fn) {\n  if (data.author) {\n    data.author = fn(data.author)\n  }['maintainers', 'contributors'].forEach(function (set) {\n    if (!Array.isArray(data[set])) {\n      return\n    }\n    data[set] = data[set].map(fn)\n  })\n  return data\n}\n\nfunction unParsePerson (person) {\n  if (typeof person === 'string') {\n    return person\n  }\n  var name = person.name || ''\n  var u = person.url || person.web\n  var url = u ? (' (' + u + ')') : ''\n  var e = person.email || person.mail\n  var email = e ? (' <' + e + '>') : ''\n  return name + email + url\n}\n\nfunction parsePerson (person) {\n  if (typeof person !== 'string') {\n    return person\n  }\n  var name = person.match(/^([^(<]+)/)\n  var url = person.match(/\\(([^)]+)\\)/)\n  var email = person.match(/<([^>]+)>/)\n  var obj = {}\n  if (name && name[0].trim()) {\n    obj.name = name[0].trim()\n  }\n  if (email) {\n    obj.email = email[1]\n  }\n  if (url) {\n    obj.url = url[1]\n  }\n  return obj\n}\n\nfunction addOptionalDepsToDeps (data, warn) {\n  var o = data.optionalDependencies\n  if (!o) {\n    return\n  }\n  var d = data.dependencies || {}\n  Object.keys(o).forEach(function (k) {\n    d[k] = o[k]\n  })\n  data.dependencies = d\n}\n\nfunction depObjectify (deps, type, warn) {\n  if (!deps) {\n    return {}\n  }\n  if (typeof deps === 'string') {\n    deps = deps.trim().split(/[\\n\\r\\s\\t ,]+/)\n  }\n  if (!Array.isArray(deps)) {\n    return deps\n  }\n  warn('deprecatedArrayDependencies', type)\n  var o = {}\n  deps.filter(function (d) {\n    return typeof d === 'string'\n  }).forEach(function (d) {\n    d = d.trim().split(/(:?[@\\s><=])/)\n    var dn = d.shift()\n    var dv = d.join('')\n    dv = dv.trim()\n    dv = dv.replace(/^@/, '')\n    o[dn] = dv\n  })\n  return o\n}\n\nfunction objectifyDeps (data, warn) {\n  depTypes.forEach(function (type) {\n    if (!data[type]) {\n      return\n    }\n    data[type] = depObjectify(data[type], type, warn)\n  })\n}\n\nfunction bugsTypos (bugs, warn) {\n  if (!bugs) {\n    return\n  }\n  Object.keys(bugs).forEach(function (k) {\n    if (typos.bugs[k]) {\n      warn('typo', k, typos.bugs[k], 'bugs')\n      bugs[typos.bugs[k]] = bugs[k]\n      delete bugs[k]\n    }\n  })\n}\n"]},"metadata":{},"sourceType":"script"}